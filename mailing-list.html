<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ä–æ–∑—Å–∏–ª–∫–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<style>
    body {
        font-family: sans-serif;
        background-color: #fff;
        color: #222;
        font-size: 14px;
        margin: 0;
        padding: 0;
    }

    .center {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .padding-top {
        padding-top: 1rem;
    }

    .padding-bottom-1 {
        padding-bottom: 1rem;
    }

    .padding-bottom-3 {
        padding-bottom: 3rem;
    }

    .btn-full-width {
        display: flex;
        justify-content: center;
        margin: 5px;
        width: -webkit-fill-available;
    }

    .container {
    }

    .container h1 {
        font-size: 18px;
        margin-top: 0;
        margin-bottom: 20px;
    }

    .container ul {
        list-style: none;
        margin: 0;
        padding: 0;
        display: inline-block;
    }

    .container li {
        display: inline-block;
        background: #e1e3e3;
        color: #232F34;
        padding: 3px 5px 3px 10px;
        border-radius: 15px;
        margin-top: 10px;
        margin-right: 5px;
    }

    .container a {
        color: #e1e3e3;
        text-decoration: none;
        margin-left: 7px;
        margin-right: 3px;
        margin-bottom: 3px;
        font-size: 10px;
        background: #666666;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        display: inline-flex;
        text-align: center;
        align-items: center;
        justify-content: center;
    }

    .container a:hover {
        color: red;
    }

    .checkbox-lg .form-check-input {
        top: .8rem;
        scale: 1.4;
        margin-right: 0.7rem;
    }

    .checkbox-lg .form-check-label {
        padding-top: 13px;
    }

    .checkbox-xl .form-check-input {
        top: 1.2rem;
        scale: 1.7;
        margin-right: 0.8rem;
        margin-left: -18px;
    }

    .checkbox-xl .form-check-label {
        padding-left: 10px;
    }

    .switch-container {
        display: flex;
        flex-wrap: nowrap;
        justify-content: flex-start;
        align-items: center;
        flex-direction: row;
    }

</style>
<body>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>

<button type="button"
        id="closeBtn"
        class="btn btn-danger btn-full-width">–ó–∞–∫—Ä–∏—Ç–∏ —Ç–∞ –≤–∏–π—Ç–∏
</button>
<div class="mt-3 text-center fs-1">–†–æ–∑—Å–∏–ª–∫–∞</div>
<div class="container-md">
    <div class="padding-top"></div>
    <div class="card m-2">
        <div class="card-header">
            <div class="text-center fs-5">–¢–µ–∫—Å—Ç —Ä–æ–∑—Å–∏–ª–∫–∏</div>
        </div>
        <div class="card-body" id="messageText">
            <textarea class="form-control" aria-label="With textarea" rows="7"></textarea>
        </div>
    </div>
    <div class="padding-top"></div>
    <div class="card m-2">
        <div class="card-header">
            <div class="text-center fs-5">–û—Ç—Ä–∏–º—É–≤–∞—á—ñ</div>
        </div>
        <div class="card-body">
            <select class="form-select" aria-label="Default select example" id="subTypeGroup">
                <option selected value="allExceptPaidSubs">üì¢ –£—Å—ñ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏ –û–ö–†–Ü–ú –ü–õ–ê–¢–ù–ò–•</option>
                <option value="allSubs">üìù –£—Å—ñ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏</option>
                <option value="testSubs">‚è≤Ô∏è –¢–µ—Å—Ç–æ–≤—ñ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏</option>
                <option value="paidSubs">üí∂ –ü–ª–∞—Ç–Ω—ñ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏</option>
                <option value="expiredSubs">‚õîÔ∏è –Ü–∑ –∑–∞–∫—ñ–Ω—á–µ–Ω–æ—é –ø—ñ–¥–ø–∏—Å–∫–æ—é</option>
            </select>
        </div>
    </div>
    <div class="padding-top"></div>
    <div>
        <div class="card m-2">
            <div class="card-header">
                <div class="text-center fs-5">–ü–æ—Å–ª—É–≥–∞</div>
            </div>
            <div class="card-body">
                <select class="form-select" aria-label="Default select example" id="subjectsGroup">
                    <option selected value="allSubjects">–£—Å—ñ –ø–æ—Å–ª—É–≥–∏</option>
                    <option value="passAndPost">–ü–∞—Å–∞–∂–∏—Ä—Å—å–∫—ñ –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–Ω—è —Ç–∞ –ø–æ—Å–∏–ª–∫–∏</option>
                    <option value="pass">–ü–∞—Å–∞–∂–∏—Ä—Å—å–∫—ñ –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–Ω—è</option>
                    <option value="cargo">–í–∞–Ω—Ç–∞–∂–Ω—ñ –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–Ω—è –ø–æ –∫—Ä–∞—ó–Ω—ñ</option>
                    <option value="indiv">–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä</option>
                    <option value="animals">–ü–µ—Ä–µ–≤–µ–∑–µ–Ω–Ω—è —Ç–≤–∞—Ä–∏–Ω</option>
                    <option value="photo">–§–æ—Ç–æ–≥—Ä–∞—Ñ</option>
                    <option value="renovation">–ó–±–∏—Ä–∞–Ω–Ω—è –º–µ–±–ª—ñ–≤</option>
                    <option value="renovationAndRepair">–ó–±–∏—Ä–∞–Ω–Ω—è –º–µ–±–ª—ñ–≤ —ñ —Ä–µ–º–æ–Ω—Ç –∫–≤–∞—Ä—Ç–∏—Ä</option>
                    <option value="brows">–ë—Ä–æ–≤–∏ / –í—ñ—ó</option>
                    <option value="manicure">–ú–∞–Ω—ñ–∫—é—Ä / –ü–µ–¥—ñ–∫—é—Ä</option>
                    <option value="perukar">–ü–µ—Ä—É–∫–∞—Ä</option>
                    <option value="hairMaster">–ú–∞–π—Å—Ç–µ—Ä –∑ –≤–æ–ª–æ—Å—Å—è</option>
                    <option value="makeup">–ú–∞–∫—ñ—è–∂ / –í—ñ–∑–∞–∂</option>
                    <option value="cosmo">–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥—ñ—á–Ω—ñ –ø–æ—Å–ª—É–≥–∏</option>
                    <option value="permanent">–ü–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω–∏–π –º–∞–∫—ñ—è–∂</option>
                    <option value="massage">–ú–∞—Å–∞–∂</option>
                    <option value="cleaning">–ö–ª—ñ–Ω—ñ–Ω–≥–æ–≤—ñ –ø–æ—Å–ª—É–≥–∏</option>
                    <option value="enCourses">–ö—É—Ä—Å–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="bulgCourses">–ö—É—Ä—Å–∏ –±–æ–ª–≥–∞—Ä—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="spainCourses">–ö—É—Ä—Å–∏ —ñ—Å–ø–∞–Ω—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="itCourses">–ö—É—Ä—Å–∏ —ñ—Ç–∞–ª—ñ–π—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="lithuanianCourses">–ö—É—Ä—Å–∏ –ª–∏—Ç–æ–≤—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="neCourses">–ö—É—Ä—Å–∏ –Ω—ñ–¥–µ—Ä–ª–∞–Ω–¥—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="deCourses">–ö—É—Ä—Å–∏ –Ω—ñ–º–µ—Ü—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="portugalCourses">–ö—É—Ä—Å–∏ –ø–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="polandCourses">–ö—É—Ä—Å–∏ –ø–æ–ª—å—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="romaniaCourses">–ö—É—Ä—Å–∏ —Ä—É–º—É–Ω—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="slovakiaCourses">–ö—É—Ä—Å–∏ —Å–ª–æ–≤–∞—Ü—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="czechCourses">–ö—É—Ä—Å–∏ —á–µ—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="tuCourses">–ö—É—Ä—Å–∏ —Ç—É—Ä–µ—Ü—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="uaCourses">–ö—É—Ä—Å–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="frCourses">–ö—É—Ä—Å–∏ —Ñ—Ä–∞–Ω—Ü—É–∑—å–∫–æ—ó –º–æ–≤–∏ –æ–Ω–ª–∞–π–Ω</option>
                    <option value="tattoo">–¢–∞—Ç—É / –ü—ñ—Ä—Å–∏–Ω–≥</option>
                </select>
            </div>
        </div>
    </div>
    <div class="padding-top"></div>
    <div>
        <div class="card m-2">
            <div class="card-header">
                <div class="text-center fs-5">–ö—Ä–∞—ó–Ω–∞</div>
            </div>
            <div class="card-body">
                <select class="form-select" aria-label="Default select example" id="countryGroup">
                    <option selected value="allCountries">–£—Å—ñ –∫—Ä–∞—ó–Ω–∏</option>
                    <option value="de">–ù—ñ–º–µ—á—á–∏–Ω–∞</option>
                    <option value="au">–ê–≤—Å—Ç—Ä—ñ—è</option>
                    <option value="alb">–ê–ª–±–∞–Ω—ñ—è</option>
                    <option value="belg">–ë–µ–ª—å–≥—ñ—è</option>
                    <option value="bulg">–ë–æ–ª–≥–∞—Ä—ñ—è</option>
                    <option value="bosn">–ë–æ—Å–Ω—ñ—è —ñ –ì–µ—Ä—Ü–æ–≥–æ–≤–∏–Ω–∞</option>
                    <option value="brit">–ë—Ä–∏—Ç–∞–Ω—ñ—è</option>
                    <option value="greece">–ì—Ä–µ—Ü—ñ—è</option>
                    <option value="georg">–ì—Ä—É–∑—ñ—è</option>
                    <option value="denm">–î–∞–Ω—ñ—è</option>
                    <option value="est">–ï—Å—Ç–æ–Ω—ñ—è</option>
                    <option value="egypt">–Ñ–≥–∏–ø–µ—Ç</option>
                    <option value="irl">–Ü—Ä–ª–∞–Ω–¥—ñ—è</option>
                    <option value="spain">–Ü—Å–ø–∞–Ω—ñ—è</option>
                    <option value="it">–Ü—Ç–∞–ª—ñ—è</option>
                    <option value="cyprus">–ö—ñ–ø—Ä</option>
                    <option value="latv">–õ–∞—Ç–≤—ñ—è</option>
                    <option value="lith">–õ–∏—Ç–≤–∞</option>
                    <option value="licht">–õ—ñ—Ö—Ç–µ–Ω—à—Ç–µ–π–Ω</option>
                    <option value="lux">–õ—é–∫—Å–µ–º–±—É—Ä–≥</option>
                    <option value="malta">–ú–∞–ª—å—Ç–∞</option>
                    <option value="moldova">–ú–æ–ª–¥–æ–≤–∞</option>
                    <option value="neth">–ù—ñ–¥–µ—Ä–ª–∞–Ω–¥–∏</option>
                    <option value="norw">–ù–æ—Ä–≤–µ–≥—ñ—è</option>
                    <option value="oae">–û–ê–ï</option>
                    <option value="maked">–ü—ñ–≤–Ω—ñ—á–Ω–∞ –ú–∞–∫–µ–¥–æ–Ω—ñ—è</option>
                    <option value="pol">–ü–æ–ª—å—â–∞</option>
                    <option value="port">–ü–æ—Ä—Ç—É–≥–∞–ª—ñ—è</option>
                    <option value="rom">–†—É–º—É–Ω—ñ—è</option>
                    <option value="serb">–°–µ—Ä–±—ñ—è</option>
                    <option value="slovak">–°–ª–æ–≤–∞—á—á–∏–Ω–∞</option>
                    <option value="sloven">–°–ª–æ–≤–µ–Ω—ñ—è</option>
                    <option value="thai">–¢–∞—ó–ª–∞–Ω–¥</option>
                    <option value="turk">–¢—É—Ä–µ—á—á–∏–Ω–∞</option>
                    <option value="hung">–£–≥–æ—Ä—â–∏–Ω–∞</option>
                    <option value="finl">–§—ñ–Ω–ª—è–Ω–¥—ñ—è</option>
                    <option value="fran">–§—Ä–∞–Ω—Ü—ñ—è</option>
                    <option value="croat">–•–æ—Ä–≤–∞—Ç—ñ—è</option>
                    <option value="czech">–ß–µ—Ö—ñ—è</option>
                    <option value="monten">–ß–æ—Ä–Ω–æ–≥–æ—Ä—ñ—è</option>
                    <option value="swed">–®–≤–µ–π—Ü–∞—Ä—ñ—è</option>
                    <option value="swis">–®–≤–µ—Ü—ñ—è</option>
                </select>
            </div>
        </div>
        <div class="form-check form-switch checkbox-xl switch-container">
            <input class="form-check-input" type="checkbox" role="switch" id="exceptSwitch"
                   style="form-switch-width: 5em">
            <label class="form-check-label fs-4" for="exceptSwitch">–î–æ–¥–∞—Ç–∏ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è</label>
        </div>
        <div id="subExpGroup">
            <div class="container padding-top">
                <input type="text"
                       id="exceptInput"
                       class="form-control"
                       placeholder="–í–≤–µ–¥—ñ—Ç—å Username –∞–±–æ CHAT ID"
                       hidden>
                <div id="exceptInputValidation" class="invalid-feedback">
                    CHAT ID –∞–±–æ Username –≤–∂–µ –±—É–≤ –≤–≤–µ–¥–µ–Ω–∏–π
                </div>
                <ul id="list"></ul>
            </div>
        </div>
    </div>
</div>
<div class="padding-bottom-3"></div>
</body>
<script type="application/javascript">
    let items = [];
    let hasText = false
    let mailText = '';
    let subType = "allExceptPaidSubs";
    let subject = "allSubjects";
    let country = "allCountries";
    let messageText = document.getElementById('messageText');
    let subTypeGroup = document.getElementById('subTypeGroup');
    let subjectsGroup = document.getElementById('subjectsGroup');
    let countryGroup = document.getElementById('countryGroup');
    let exceptSwitch = document.getElementById('exceptSwitch');
    let exceptInput = document.getElementById('exceptInput');
    let list = document.getElementById('list');

    messageText.addEventListener('input', event => {
        hasText = event.target.value.trim() !== '';
        mailText = event.target.value.trim();
        isMainButtonActive()
    }, false);

    subTypeGroup.addEventListener("change", event => {
        subType = event.target.value;
        isMainButtonActive();
    }, false);

    subjectsGroup.addEventListener("change", event => {
        subject = event.target.value;
        isMainButtonActive();
    }, false);

    countryGroup.addEventListener("change", event => {
        country = event.target.value;
        isMainButtonActive();
    }, false);

    exceptInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            let val = exceptInput.value.trim();
            if (val !== '') {
                if (items.indexOf(val) >= 0) {
                    exceptInput.classList.add("is-invalid");
                } else {
                    exceptInput.classList.remove("is-invalid");
                    items.push(val);
                    render();
                    exceptInput.value = '';
                    list.scrollIntoView({behavior: 'smooth', block: 'end'})
                }
            }
        }
    });

    exceptSwitch.addEventListener("input", event => {
        if (event.target.checked) {
            exceptInput.hidden = false;
            exceptInput.focus();
        } else {
            exceptInput.hidden = true;
            items = [];
            list.innerHTML = '';
        }
    }, false);

    function render() {
        list.innerHTML = '';
        items.map((item, index) => {
            list.innerHTML += `<li><span>${item}</span><a href="javascript: remove(${index})">‚úï</a></li>`;
        });
    }

    function remove(i) {
        items = items.filter(item => items.indexOf(item) != i);
        render();
    }

    let tg = window.Telegram.WebApp
    tg.expand();

    subTypeGroup.addEventListener("input", event => {
        subType = event.target.id;
        isMainButtonActive();
        exceptSwitch.focus();
    }, false);

    function isShow() {
        return hasText && subType !== 'none';
    }

    function isMainButtonActive() {
        if (isShow()) {
            tg.MainButton.show();
        } else {
            tg.MainButton.hide();
        }
    }

    tg.MainButton.setText('–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ä–æ–∑—Å–∏–ª–∫—É');
    Telegram.WebApp.onEvent('mainButtonClicked', function () {
        const data = JSON.stringify({
            subscriptionType: subType,
            subject: subject,
            country: country,
            text: mailText,
            exceptUsers: items,
            type: 9
        });
        tg.sendData(data);
        tg.close();
    });

    let closeButton = document.getElementById("closeBtn");
    closeButton.addEventListener("click", event => {
        const data = JSON.stringify({
            type: 0,
            closeType: 'mailingList'
        });
        tg.sendData(data);
        tg.close();
    }, false);

</script>
</html>
